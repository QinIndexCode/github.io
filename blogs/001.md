## 2025-12-24 第一篇博客(JS索引)
JavaScript 中快速索引数据的方法

在 JavaScript 中，如果我们希望根据某个“键”快速找到对应的值（即实现 O(1) 时间复杂度的查找），最常用的方式就是使用**对象（Object）**或**Map** 来构建一个键值映射结构。这两种方式本质上都基于哈希表（hash table）实现，因此查找、插入和删除的平均时间复杂度都是 O(1)。

### 1. 使用普通对象（Object）

对象是最简单、最常见的快速索引方式，键必须是字符串（或 Symbol）。

```javascript
const data = {
  'key1': 'value1',
  'key2': 'value2',
  'key3': 'value3'
};

// 快速访问
console.log(data['key2']); // 输出: 'value2'
console.log(data.key2);    // 也可以用点语法（键名合法时）
```

**优点**：
- 语法简洁，创建和使用成本最低
- 适合键名已知且为字符串的场景
- 性能优秀（V8 引擎对对象优化非常好）

**缺点**：
- 键会自动转换为字符串（`{ 123: 'num' }` 的键实际上是 '"123"'）
- 不能直接用对象、数组等复杂类型作为键
- 有原型链污染风险（虽不常见，但 `__proto__` 等特殊键需注意）
- 遍历顺序在 ES2020 前不完全保证插入顺序

### 2. 使用 Map

Map 是 ES6 引入的专为键值存储设计的集合类型，键可以是**任意类型**（包括对象、函数、NaN 等）。

```javascript
const map = new Map();

map.set('key1', 'value1');
map.set('key2', 'value2');
map.set('key3', 'value3');

// 甚至可以用对象作为键
const objKey = { id: 1 };
map.set(objKey, '关联的对象值');

// 快速访问
console.log(map.get('key2'));      // 输出: 'value2'
console.log(map.get(objKey));      // 输出: '关联的对象值'
```

**优点**：
- 键可以是任何值（真正意义上的“任意类型键”）
- 严格保持插入顺序（遍历时顺序可预测）
- 内置 size 属性、has()、delete()、clear() 等实用方法
- 没有原型链问题，更安全

**缺点**：
- 相比普通对象，创建和操作略有额外开销（通常微乎其微）
- 语法稍显冗长

### 3. 两者底层原理：哈希表

无论是普通对象还是 Map，在现代 JavaScript 引擎（如 V8）中，底层都使用了**哈希表**实现。

- 当你设置一个键值对时，引擎会计算键的哈希值，把值存到哈希表对应的槽位。
- 查询时再次计算键的哈希值，直接定位到槽位取出值，因此平均时间复杂度为 O(1)。

这也是为什么它们都能实现“快速索引”。

### 4. 类似数组的索引行为


```javascript
[1, 2, 3, 4, 5][1]  // 输出: 2
```

数组在 JavaScript 中也是基于索引（整数）快速访问的，底层同样使用了类似哈希表的优化（稀疏数组会退化为对象存储）。但数组的键是**数字索引**，适合有序、连续的数据，而对象/Map 更适合任意键的映射场景。

### 5. 何时选哪种？

| 场景                                   | 推荐使用    | 原因                                      |
|----------------------------------------|-------------|-------------------------------------------|
| 键是字符串，数据量不大，追求极简语法   | Object      | 最轻量、性能最好                          |
| 需要用对象/函数等复杂类型作为键        | Map         | Object 会把键转为字符串                   |
| 需要频繁删除键或查询是否存在            | Map         | 提供 has()、delete()、size 等便捷方法     |
| 需要保持插入顺序或可迭代性             | Map         | for...of 遍历顺序固定                     |
| 键可能是数字但不想转为字符串           | Map         | 如 map.set(123, value) 与 '123' 区分开来   |
### 小结

JavaScript 提供了多种方式实现快速索引，最核心的两类是**对象**和**Map**，它们都依托哈希表实现高效查找。根据你的键类型、操作频率和功能需求选择合适的一种，就能轻松实现“根据键快速取值”的需求。
